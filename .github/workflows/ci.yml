name: ci
"on":
  - push
jobs:
  build:
    runs-on: ubuntu-20.04
    steps:
      - uses: actions/checkout@v2
      - uses: pnpm/action-setup@v2.0.1
        with:
          version: "7.12.1"
      - uses: actions/setup-node@v2
        with:
          node-version: "16.16.0"
      - run: pnpm i --frozen-lockfile
      - run: npm run lint:check
      - run: npm run tsc
      - run: npm run rakkas:build

  # TODO: investigate why `git clone` fails on CI
  #   Step 3/11 : RUN git clone --depth 1 https://github.com/WorksApplications/sudachi.rs.git
  #    ---> Running in 12f65dfff1e3
  #   fatal: could not create work tree dir 'sudachi.rs': Permission denied
  #   The command '/bin/sh -c git clone --depth 1 https://github.com/WorksApplications/sudachi.rs.git' returned a non-zero code: 128
  sudachi:
    if: false
    runs-on: ubuntu-20.04
    steps:
      - uses: actions/checkout@v2
      - run: bash sudachi/build.sh
